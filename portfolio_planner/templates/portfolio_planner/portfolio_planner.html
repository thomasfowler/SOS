{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% load djmoney %}
{% load static %}

{% block title %}Opportunity Portfolio Planner{% endblock %}

{% block content %}
    <div class="container my-5">

        {# Load the Table via HTMX #}
        <div hx-trigger="load, opportunityListChanged from:body" hx-get="{% url 'opportunity_list' %}?{{ current_params }}" hx-target="this" >
        </div>

        <button hx-get="{% url 'add_opportunity' %}" hx-target="#dialog" class="btn btn-primary">
          Add an opportunity
        </button>
    </div>

    <div id="modal" class="modal fade">
      <div id="dialog" class="modal-dialog modal-xl" hx-target="this"></div>
    </div>

    {# Custom JS #}
    <script src="{% static "js/dialog.js" %}"></script>
{% endblock %}

{% block sidebar_stats %}
<h4>Summary Stats</h4>
<ul>
    <!-- TODO: Placeholder for stats -->
    <li>Total Forecasted Revenue: {{ total_forecasted_revenue }}</li>
    <li>Total Revenue Last Fiscal: {{ total_revenue_last_fiscal }}</li>
    <li>Deals Closed: {{ deal_count }}</li>
    <li>Avg Forecasted Deal Size: {{ avg_deal_size }}</li>
    <li>Avg Deal Size Last Fiscal: {{ avg_deal_last_fiscal }}</li>
</ul>
{% endblock %}
