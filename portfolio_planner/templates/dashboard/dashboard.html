{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% load static %}

{% block title %}Science of Sales - GROW Dashboard{% endblock %}

{% block content %}
<div class="container mt-4 dashboard-container">

    <!-- Performance Table -->
    <div class="card mb-4 performance-table">
        <div class="card-header">Performance</div>
        <div class="card-body">
            <!-- Table content here -->
        </div>
    </div>

    <!-- ACTUAL vs FORECAST vs BUDGET Bar Graph -->
    <div class="card mb-4 forecast-bar-graph">
        <div class="card-header">ACTUAL vs FORECAST vs BUDGET</div>
        <div class="card-body">
            <select id="periodFilter" name="period" hx-get="actual_vs_forecast/" hx-trigger="change" hx-swap="innerHTML" hx-target="#actual-forecast-budget-chart-container" hx-vals="javascript:{period: document.getElementById('periodFilter').value, region: document.getElementById('regionFilter').value, includeArchived: document.getElementById('includeArchivedFilter').checked}">
                <option value="quarterly">Quarterly</option>
                <option value="monthly">Monthly</option>
            </select>

            <select id="regionFilter" name="region" hx-get="actual_vs_forecast/" hx-trigger="change" hx-swap="innerHTML" hx-target="#actual-forecast-budget-chart-container" hx-vals="javascript:{period: document.getElementById('periodFilter').value, region: document.getElementById('regionFilter').value, includeArchived: document.getElementById('includeArchivedFilter').checked}">
                <option disabled selected value> -- select an option -- </option>
                <option value="north">North</option>
                <option value="south">South</option>
                <!-- ... other regions ... -->
            </select>

            <input type="checkbox" id="includeArchivedFilter" name="includeArchived" hx-get="actual_vs_forecast/" hx-trigger="change" hx-swap="innerHTML" hx-target="#actual-forecast-budget-chart-container" hx-vals="javascript:{period: document.getElementById('periodFilter').value, region: document.getElementById('regionFilter').value, includeArchived: document.getElementById('includeArchivedFilter').checked}" value="true"> Include Archived

            <div id="actual-forecast-budget-chart-container" hx-get="actual_vs_forecast/" hx-trigger="load">
                <!-- Bar graph content here - rendered via HTMX -->
            </div>
        </div>
    </div>

    <!-- G.R.O.W. Status Tracker -->
    <div class="card mb-4 grow-status-tracker">
        <div class="card-header">G.R.O.W. Status Tracker</div>
        <div class="card-body">
            <select id="periodFilter" name="period" hx-get="grow_status/" hx-trigger="change" hx-swap="innerHTML" hx-target="#grow-status-chart-container" hx-vals="{period: $period.val}">
                <option value="annual">Annual</option>
                <option value="q1">Quarter 1</option>
                <option value="q2">Quarter 2</option>
                <option value="q3">Quarter 3</option>
                <option value="q4">Quarter 4</option>
                <option value="current_month">Current Month</option>
            </select>

            <div id="grow-status-chart-container" hx-get="grow_status/" hx-trigger="load">
                <!-- Bar graph content here - rendered via HTMX -->
            </div>
        </div>
    </div>

    <!-- Sales Time Left & Required Sales -->
    <div class="row mb-4 sales-section">
        <div class="col-md-6 sales-time-left">
            <!-- Sales Time Left content here -->
        </div>
        <div class="col-md-6 required-sales">
            <!-- Required Sales content here -->
        </div>
    </div>

    <!-- # Deals Pie Chart & Closing Ratios -->
    <div class="row mb-4 deals-section">
        <div class="col-md-6 deals-pie-chart">
            <!-- # Deals pie chart content here -->
        </div>
        <div class="col-md-6 closing-ratios">
            <!-- Closing Ratios content here -->
        </div>
    </div>
</div>

<script src="{% static 'js/charts.js' %}" type="text/javascript"></script>
{% endblock %}
